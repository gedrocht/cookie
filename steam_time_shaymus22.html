<html>
<head>
<style>
div {
    margin: 0px;
    padding: 0px;
}

#games {
    margin-top: 30px;
    margin-left: auto;
    margin-right: auto;
    width: 540px;
    font-family: Arial;
    margin-bottom: 0px;
    padding: 0px;
}

#game {
    height: 215px;
    margin-bottom: 30px;
}

.even {
    background-color:#eee;
    border-top: 1px solid #ccc;
}

.odd {
    background-color:#ddd;
    border-top: 1px solid #bbb;
}

#game-name {
    float: left;
}

#game-hours {
    float: right;
    padding-top: 10px;
    padding-right: 10px;
    font-size: 30pt;
}

a {
    text-decoration: none;
}

a:link    { color: #000; }
a:visited { color: #222; }
a:hover   { color: #444; }
a:active  { color: #666; }
</style>
<script src="steam_time_js.js"></script>
<script>

bad_appids = [254270,21960,12230,12240,12250,228200,70660];

function init(){
    var games = document.getElementById("games");
    games.innerHTML = getGames();
}

function getGames(){
    var s = "";
    for( var i = 0 ; i < data.length ; i++ ){
        if( validate(data[i]) )
            s += getGame(data[i]);
    }
    
    return s;
}

function validate( game ){
    return !(bad_appids.indexOf(game.appid)!=-1);
}

function getGame( game ){
    var s = "";
    
    s += getGameDiv( game.appid,
                     game.name,
                     game.time.hours_remaining,
                     game.time.hours_played/game.time.hours_required );
    
    return s;
}

function round( num ){
    var s = (Math.round(num*10)/10).toString();
    
    if( s.indexOf(".") == -1 )
        s = s + ".0";
    
    return s;
}

function makeRunLink( appid, name ){
    return '<a href="steam://run/' + appid + '" title="' + name + '">' + getGameImage(appid,name) + '</a>';
}

function getGameDiv( appid, name, remaining, percentage ){
    return "<div " + getEvenOddClass() + " id=\"game\" " + getStyle(percentage) + " >" + getGameNameDiv(appid,makeRunLink(appid,name)) + getGameHoursDiv(round(remaining)) + "</div>";// + Math.round(percentage*10)/10 + "\%</div>";
}

function getStyle( percentage ){

    if( percentage >= 1 )
        return 'style="display:none;"'

    /*
    var s = 'style="opacity:'
    
    var p = percentage;
    if( p > 1 )
        p = 1;
    p = 1 - p;
    
    s += Math.round(p*10)/30 + ';"';
    
    return s;
    */
    return "";
}

var __EVEN_ODD = false;
function getEvenOddClass(){
    __EVEN_ODD = !__EVEN_ODD
    if( __EVEN_ODD )
        return "class=\"odd\"";
    return "class=\"even\"";
}

function getGameNameDiv( appid, s ){
    return '<div id="game-name">' + s + '</div>';
}

function getGameHoursDiv( s ){
    return '<div id="game-hours">' + s + '</div>';
}

function getGameImage( appid, name ){
    return "<img src='" + getHeaderURL(appid) + "' alt='" + name + "'></img>";
}

function getHeaderURL( appid ){
    return "http://cdn.akamai.steamstatic.com/steam/apps/" + appid + "/header.jpg";
}
</script>
</head>
<body onLoad="init();">
<div id="games">
</div>
</body>
</html>
